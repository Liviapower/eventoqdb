<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Resgate Promoção Harry Potter</title>
  <link rel="icon" type="image/png" sizes="32x32" href="favicon.png">
  <style>
    /* SEU CSS ATUAL - INTACTO */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { min-height: 100vh; display: flex; justify-content: center; align-items: center; font-family: 'circular', sans-serif; background: url('estrelado.jpg') no-repeat center center; background-size: cover; background-attachment: fixed; overflow: hidden; }
    .hidden { display: none !important; }
    #tela-inicial { position: fixed; inset: 0; display: flex; justify-content: center; align-items: center; cursor: pointer; z-index: 10000; transition: opacity 0.5s ease; }
    #carta-imagem { height: 80vh; aspect-ratio: 3/4; background: url('hp.png') no-repeat center center/contain; border: none; transition: transform 0.3s ease; }
    #tela-inicial:hover #carta-imagem { transform: scale(1.02); }
    .magic-dust { position: fixed; top: 50%; left: 50%; width: 10px; height: 10px; background: radial-gradient(circle, rgba(255,223,150,0.8) 0%, rgba(255,215,0,0) 70%); border-radius: 50%; pointer-events: none; z-index: 9999; opacity: 0; animation: magic-burst 1s ease-out forwards; }
    @keyframes magic-burst { 0% { transform: translate(-50%, -50%) scale(0); opacity: 1; } 100% { transform: translate(-50%, -50%) scale(200); opacity: 0; } }
    .form-wrapper { background: rgba(255, 255, 255, 0.95); padding: 40px; border-radius: 16px; width: 100%; max-width: 420px; box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3); text-align: center; transition: opacity 0.8s ease; }
    h1 { font-size: 22px; margin-bottom: 20px; color: #0b3d91; }
    form label { display: block; text-align: left; margin: 12px 0 5px; font-weight: bold; font-size: 14px; }
    form input { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #aaa; margin-bottom: 15px; font-size: 14px; }
    button:disabled { background-color: #ccc; cursor: not-allowed; }
    button { width: 100%; padding: 14px; background: #0b3d91; color: #fff; border: none; border-radius: 8px; font-weight: bold; font-size: 16px; cursor: pointer; transition: background 0.3s ease; }
    .checkbox-label { display: flex; align-items: center; text-align: left; font-size: 14px; margin-bottom: 15px; }
    .checkbox-label input { width: auto; margin-right: 10px; margin-bottom: 0; }
  </style>
</head>
<body>

  <div id="tela-inicial"><div id="carta-imagem"></div></div>
  
  <!-- Formulário que redireciona para a página de voucher -->
  <form name="promoForm" data-netlify="true" action="/voucher.html" class="form-wrapper hidden">
    <input type="hidden" name="CUPOM" id="cupom-hidden-input">
    
    <h1>Resgate seu Cupom</h1>
    <label for="nome">Nome completo *</label>
    <input type="text" id="nome" name="NOME" required>
    <label for="cpf">CPF *</label>
    <input type="text" id="cpf" name="CPF" required placeholder="000.000.000-00" maxlength="14">
    <label class="checkbox-label">
      <input type="checkbox" id="politica" name="politica" required> Li e concordo com a Política de Privacidade.
    </label>
    <button type="submit" id="submit-button" disabled>Resgatar meu cupom</button>
  </form>

  <script>
    const telaInicial = document.getElementById('tela-inicial');
    const formWrapper = document.querySelector('.form-wrapper');
    const form = document.forms.promoForm;
    const nomeInput = document.getElementById('nome');
    const cpfInput = document.getElementById('cpf');
    const politicaCheckbox = document.getElementById('politica');
    const submitButton = document.getElementById('submit-button');
    const cupomHiddenInput = document.getElementById('cupom-hidden-input');

    // Lógica para pular direto para o voucher se já tiver um
    document.addEventListener('DOMContentLoaded', () => {
      const cupomSalvo = localStorage.getItem('meuCupomQDBHP');
      if (cupomSalvo) {
        // Redireciona para a página do voucher com o cupom salvo
        window.location.href = `/voucher.html?cupom=${cupomSalvo}`;
      }
    });

    // Lógica da animação
    telaInicial.addEventListener('click', () => {
      telaInicial.style.opacity = '0';
      setTimeout(() => { telaInicial.classList.add('hidden'); }, 500);
      const dust = document.createElement('div');
      dust.className = 'magic-dust';
      document.body.appendChild(dust);
      setTimeout(() => {
        formWrapper.classList.remove('hidden');
        dust.remove();
      }, 1000);
    });

    // Lógica de validação
    function validarCPF(cpf) { /* ... sua função de validarCPF aqui ... */ return true; }
    function checkFormValidity() { submitButton.disabled = !(nomeInput.value.trim() !== '' && validarCPF(cpfInput.value) && politicaCheckbox.checked); }
    [nomeInput, cpfInput, politicaCheckbox].forEach(el => el.addEventListener('input', checkFormValidity));
    
    // Lógica que gera o cupom ANTES do envio
    form.addEventListener('submit', () => {
      const cpfLimpo = cpfInput.value.replace(/\D/g, '');
      const hashSimples = (parseInt(cpfLimpo.substr(0, 9)) % 10000).toString().padStart(4, '0');
      const novoCodigo = `QDBHP${hashSimples}`;
      cupomHiddenInput.value = novoCodigo;
    });
  </script>

</body>
</html>

</html>


